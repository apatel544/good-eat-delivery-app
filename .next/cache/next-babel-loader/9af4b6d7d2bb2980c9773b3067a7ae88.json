{"ast":null,"code":"import _regeneratorRuntime from \"@babel/runtime/regenerator\";\nimport _asyncToGenerator from \"@babel/runtime/helpers/esm/asyncToGenerator\";\nimport firebase from \"firebase/compat/app\";\nimport 'firebase/compat/auth';\nimport { initializeApp } from \"firebase/app\";\nimport { useEffect } from \"react\";\nimport Router from \"next/router\";\nimport Cookie from \"js-cookie\";\nimport axios from \"axios\";\nvar API_URL = process.env.NEXT_PUBLIC_API_URL || \"http://localhost:1337\";\nvar firebaseConfig = {\n  apiKey: \"AIzaSyDuZ-LwCCSahX6j2T8QdUmq8mR4XZkqhmw\",\n  authDomain: \"goodeats-delivery.firebaseapp.com\",\n  projectId: \"goodeats-delivery\",\n  storageBucket: \"goodeats-delivery.appspot.com\",\n  messagingSenderId: \"851617425804\",\n  appId: \"1:851617425804:web:d55699e0562b2b4e1d8ea9\"\n}; // Initialize Firebase \n\nfirebase.initializeApp(firebaseConfig);\nexport var auth = firebase.auth();\nvar provider = new firebase.auth.GoogleAuthProvider();\nprovider.setCustomParameters({\n  prompt: 'select_account'\n});\nvar googleEmail = '';\nvar googleUID = '';\nvar googleDis = '';\nexport var signInWithGoogle = /*#__PURE__*/function () {\n  var _ref = _asyncToGenerator( /*#__PURE__*/_regeneratorRuntime.mark(function _callee() {\n    var res;\n    return _regeneratorRuntime.wrap(function _callee$(_context) {\n      while (1) {\n        switch (_context.prev = _context.next) {\n          case 0:\n            _context.next = 2;\n            return auth.signInWithPopup(provider);\n\n          case 2:\n            res = _context.sent;\n            googleEmail = res.user.email;\n            googleUID = res.user.uid;\n            googleDis = res.user.displayName;\n\n            if (!false) {\n              _context.next = 8;\n              break;\n            }\n\n            return _context.abrupt(\"return\");\n\n          case 8:\n            return _context.abrupt(\"return\", new Promise(function (resolve, reject) {\n              console.log('EMAIL: ', googleEmail);\n              console.log('UID ', res.user.uid);\n              console.log('DISPLAY NAME ', res.user.displayName);\n              axios.post(\"\".concat(API_URL, \"/auth/local/register\"), {\n                username: googleDis,\n                email: googleEmail,\n                password: googleUID\n              }) // .post(`${API_URL}/api/google/login/`, {identifier: googleEmail, password: googleUID })\n              // .post(`${API_URL}/api/auth/google/login/`, { googleAccess })\n              .then(function (response) {\n                //set token response from Strapi for server validation\n                Cookie.set(\"token\", response.data.jwt); //resolve the promise to set loading to false in SignUp form\n\n                resolve(response); //redirect back to home page for restaurance selection\n\n                Router.push(\"/\");\n                console.log(\"Google Login Success\");\n              })[\"catch\"](function (error) {\n                //reject the promise and pass the error object back to the form\n                // reject(error);\n                console.log(\"Google Login Fail\");\n              });\n            }));\n\n          case 9:\n          case \"end\":\n            return _context.stop();\n        }\n      }\n    }, _callee);\n  }));\n\n  return function signInWithGoogle() {\n    return _ref.apply(this, arguments);\n  };\n}();","map":null,"metadata":{},"sourceType":"module"}