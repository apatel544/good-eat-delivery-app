{"ast":null,"code":"import firebase from \"firebase/compat/app\";\nimport 'firebase/compat/auth';\nimport { initializeApp } from \"firebase/app\";\nimport { useEffect } from \"react\";\nimport Router from \"next/router\";\nimport Cookie from \"js-cookie\";\nimport axios from \"axios\";\nconst API_URL = process.env.NEXT_PUBLIC_API_URL || \"http://localhost:1337\";\nconst firebaseConfig = {\n  apiKey: \"AIzaSyDuZ-LwCCSahX6j2T8QdUmq8mR4XZkqhmw\",\n  authDomain: \"goodeats-delivery.firebaseapp.com\",\n  projectId: \"goodeats-delivery\",\n  storageBucket: \"goodeats-delivery.appspot.com\",\n  messagingSenderId: \"851617425804\",\n  appId: \"1:851617425804:web:d55699e0562b2b4e1d8ea9\"\n}; // Initialize Firebase \n\nfirebase.initializeApp(firebaseConfig);\nexport const auth = firebase.auth();\nconst provider = new firebase.auth.GoogleAuthProvider();\nprovider.setCustomParameters({\n  prompt: 'select_account'\n});\nlet googleEmail = '';\nlet googleUID = '';\nlet googleDis = '';\nexport const signInWithGoogle = async () => {\n  const res = await auth.signInWithPopup(provider);\n  googleEmail = res.user.email;\n  googleUID = res.user.uid;\n  googleDis = res.user.displayName;\n\n  if (true) {\n    return;\n  }\n\n  return new Promise((resolve, reject) => {\n    console.log('EMAIL: ', googleEmail);\n    console.log('UID ', res.user.uid);\n    console.log('DISPLAY NAME ', res.user.displayName);\n    axios.post(`${API_URL}/auth/local/register`, {\n      username: googleDis,\n      email: googleEmail,\n      password: googleUID\n    }) // .post(`${API_URL}/api/google/login/`, {identifier: googleEmail, password: googleUID })\n    // .post(`${API_URL}/api/auth/google/login/`, { googleAccess })\n    .then(response => {\n      //set token response from Strapi for server validation\n      Cookie.set(\"token\", response.data.jwt); //resolve the promise to set loading to false in SignUp form\n\n      resolve(response); //redirect back to home page for restaurance selection\n\n      Router.push(\"/\");\n      console.log(\"Google Login Success\");\n    }).catch(error => {\n      //reject the promise and pass the error object back to the form\n      // reject(error);\n      console.log(\"Google Login Fail\");\n    });\n  });\n};","map":null,"metadata":{},"sourceType":"module"}