{"ast":null,"code":"import firebase from \"firebase/compat/app\";\nimport 'firebase/compat/auth';\nimport { initializeApp } from \"firebase/app\";\nimport { useEffect } from \"react\";\nimport Router from \"next/router\";\nimport Cookie from \"js-cookie\";\nimport axios from \"axios\";\nconst API_URL = process.env.NEXT_PUBLIC_API_URL || \"http://localhost:1337\";\nconst firebaseConfig = {\n  apiKey: \"AIzaSyDuZ-LwCCSahX6j2T8QdUmq8mR4XZkqhmw\",\n  authDomain: \"goodeats-delivery.firebaseapp.com\",\n  projectId: \"goodeats-delivery\",\n  storageBucket: \"goodeats-delivery.appspot.com\",\n  messagingSenderId: \"851617425804\",\n  appId: \"1:851617425804:web:d55699e0562b2b4e1d8ea9\"\n};\n\n// Initialize Firebase \nfirebase.initializeApp(firebaseConfig);\nexport const auth = firebase.auth();\nconst provider = new firebase.auth.GoogleAuthProvider();\nprovider.setCustomParameters({\n  prompt: 'select_account'\n});\nlet googleEmail = '';\nlet googleUID = '';\nlet googleDis = '';\nexport const signInWithGoogle = async () => {\n  const res = await auth.signInWithPopup(provider);\n  googleEmail = res.user.email;\n  googleUID = res.user.uid;\n  googleDis = res.user.displayName;\n  if (true) {\n    return;\n  }\n  return new Promise((resolve, reject) => {\n    console.log('EMAIL: ', googleEmail);\n    console.log('UID ', res.user.uid);\n    console.log('DISPLAY NAME ', res.user.displayName);\n    axios.post(`${API_URL}/auth/local/register`, {\n      username: googleDis,\n      email: googleEmail,\n      password: googleUID\n    })\n    // .post(`${API_URL}/api/google/login/`, {identifier: googleEmail, password: googleUID })\n    // .post(`${API_URL}/api/auth/google/login/`, { googleAccess })\n    .then(response => {\n      //set token response from Strapi for server validation\n      Cookie.set(\"token\", response.data.jwt);\n\n      //resolve the promise to set loading to false in SignUp form\n      resolve(response);\n      //redirect back to home page for restaurance selection\n      Router.push(\"/\");\n      console.log(\"Google Login Success\");\n    }).catch(error => {\n      //reject the promise and pass the error object back to the form\n      // reject(error);\n      console.log(\"Google Login Fail\");\n    });\n  });\n};","map":{"version":3,"names":["firebase","initializeApp","useEffect","Router","Cookie","axios","API_URL","process","env","NEXT_PUBLIC_API_URL","firebaseConfig","apiKey","authDomain","projectId","storageBucket","messagingSenderId","appId","auth","provider","GoogleAuthProvider","setCustomParameters","prompt","googleEmail","googleUID","googleDis","signInWithGoogle","res","signInWithPopup","user","email","uid","displayName","Promise","resolve","reject","console","log","post","username","password","then","response","set","data","jwt","push","catch","error"],"sources":["/Users/ankurpatel/Desktop/Projects/2022_projects/delivery-capstone/good-eat-delivery-app/components/firebase.js"],"sourcesContent":["import firebase from \"firebase/compat/app\";\nimport 'firebase/compat/auth';\nimport { initializeApp } from \"firebase/app\";\nimport { useEffect } from \"react\";\nimport Router from \"next/router\";\nimport Cookie from \"js-cookie\";\nimport axios from \"axios\";\n\nconst API_URL = process.env.NEXT_PUBLIC_API_URL || \"http://localhost:1337\";\n\n\nconst firebaseConfig = {\n  apiKey: \"AIzaSyDuZ-LwCCSahX6j2T8QdUmq8mR4XZkqhmw\",\n  authDomain: \"goodeats-delivery.firebaseapp.com\",\n  projectId: \"goodeats-delivery\",\n  storageBucket: \"goodeats-delivery.appspot.com\",\n  messagingSenderId: \"851617425804\",\n  appId: \"1:851617425804:web:d55699e0562b2b4e1d8ea9\"\n};\n\n// Initialize Firebase \nfirebase.initializeApp(firebaseConfig);\n\nexport const auth = firebase.auth();\n\n\nconst provider = new firebase.auth.GoogleAuthProvider();\nprovider.setCustomParameters({ prompt: 'select_account' });\n\nlet googleEmail = '';\nlet googleUID = '';\nlet googleDis = '';\nexport const signInWithGoogle = async () => {\n  \n    const res = await auth.signInWithPopup(provider)\n    googleEmail = res.user.email;\n    googleUID = res.user.uid;\n    googleDis = res.user.displayName\n    \n\n    if (typeof window === \"undefined\") {\n      return;\n    }\n  \n    return new Promise((resolve, reject) => {\n      console.log('EMAIL: ', googleEmail)\n      console.log('UID ', res.user.uid)\n      console.log('DISPLAY NAME ', res.user.displayName)\n      axios\n        .post(`${API_URL}/auth/local/register`, {username: googleDis, email: googleEmail, password: googleUID })\n        // .post(`${API_URL}/api/google/login/`, {identifier: googleEmail, password: googleUID })\n        // .post(`${API_URL}/api/auth/google/login/`, { googleAccess })\n        .then((response) => {\n          //set token response from Strapi for server validation\n          Cookie.set(\"token\", response.data.jwt);\n  \n          //resolve the promise to set loading to false in SignUp form\n          resolve(response);\n          //redirect back to home page for restaurance selection\n          Router.push(\"/\");\n          console.log(\"Google Login Success\")\n        })\n        .catch((error) => {\n          //reject the promise and pass the error object back to the form\n          // reject(error);\n          console.log(\"Google Login Fail\")\n        });\n    });\n    \n};\n"],"mappings":"AAAA,OAAOA,QAAQ,MAAM,qBAAqB;AAC1C,OAAO,sBAAsB;AAC7B,SAASC,aAAa,QAAQ,cAAc;AAC5C,SAASC,SAAS,QAAQ,OAAO;AACjC,OAAOC,MAAM,MAAM,aAAa;AAChC,OAAOC,MAAM,MAAM,WAAW;AAC9B,OAAOC,KAAK,MAAM,OAAO;AAEzB,MAAMC,OAAO,GAAGC,OAAO,CAACC,GAAG,CAACC,mBAAmB,IAAI,uBAAuB;AAG1E,MAAMC,cAAc,GAAG;EACrBC,MAAM,EAAE,yCAAyC;EACjDC,UAAU,EAAE,mCAAmC;EAC/CC,SAAS,EAAE,mBAAmB;EAC9BC,aAAa,EAAE,+BAA+B;EAC9CC,iBAAiB,EAAE,cAAc;EACjCC,KAAK,EAAE;AACT,CAAC;;AAED;AACAhB,QAAQ,CAACC,aAAa,CAACS,cAAc,CAAC;AAEtC,OAAO,MAAMO,IAAI,GAAGjB,QAAQ,CAACiB,IAAI,EAAE;AAGnC,MAAMC,QAAQ,GAAG,IAAIlB,QAAQ,CAACiB,IAAI,CAACE,kBAAkB,EAAE;AACvDD,QAAQ,CAACE,mBAAmB,CAAC;EAAEC,MAAM,EAAE;AAAiB,CAAC,CAAC;AAE1D,IAAIC,WAAW,GAAG,EAAE;AACpB,IAAIC,SAAS,GAAG,EAAE;AAClB,IAAIC,SAAS,GAAG,EAAE;AAClB,OAAO,MAAMC,gBAAgB,GAAG,YAAY;EAExC,MAAMC,GAAG,GAAG,MAAMT,IAAI,CAACU,eAAe,CAACT,QAAQ,CAAC;EAChDI,WAAW,GAAGI,GAAG,CAACE,IAAI,CAACC,KAAK;EAC5BN,SAAS,GAAGG,GAAG,CAACE,IAAI,CAACE,GAAG;EACxBN,SAAS,GAAGE,GAAG,CAACE,IAAI,CAACG,WAAW;EAGhC,UAAmC;IACjC;EACF;EAEA,OAAO,IAAIC,OAAO,CAAC,CAACC,OAAO,EAAEC,MAAM,KAAK;IACtCC,OAAO,CAACC,GAAG,CAAC,SAAS,EAAEd,WAAW,CAAC;IACnCa,OAAO,CAACC,GAAG,CAAC,MAAM,EAAEV,GAAG,CAACE,IAAI,CAACE,GAAG,CAAC;IACjCK,OAAO,CAACC,GAAG,CAAC,eAAe,EAAEV,GAAG,CAACE,IAAI,CAACG,WAAW,CAAC;IAClD1B,KAAK,CACFgC,IAAI,CAAE,GAAE/B,OAAQ,sBAAqB,EAAE;MAACgC,QAAQ,EAAEd,SAAS;MAAEK,KAAK,EAAEP,WAAW;MAAEiB,QAAQ,EAAEhB;IAAU,CAAC;IACvG;IACA;IAAA,CACCiB,IAAI,CAAEC,QAAQ,IAAK;MAClB;MACArC,MAAM,CAACsC,GAAG,CAAC,OAAO,EAAED,QAAQ,CAACE,IAAI,CAACC,GAAG,CAAC;;MAEtC;MACAX,OAAO,CAACQ,QAAQ,CAAC;MACjB;MACAtC,MAAM,CAAC0C,IAAI,CAAC,GAAG,CAAC;MAChBV,OAAO,CAACC,GAAG,CAAC,sBAAsB,CAAC;IACrC,CAAC,CAAC,CACDU,KAAK,CAAEC,KAAK,IAAK;MAChB;MACA;MACAZ,OAAO,CAACC,GAAG,CAAC,mBAAmB,CAAC;IAClC,CAAC,CAAC;EACN,CAAC,CAAC;AAEN,CAAC"},"metadata":{},"sourceType":"module"}